version: '3.0'

expectations:

  population_size: 50000

actions:

  design:
    run: r:latest analysis/R/design.R
    outputs:
      moderately_sensitive:
        metadata: output/metadata/metadata*
        chars: output/metadata/baseline_characteristics.rds
        formula: output/metadata/list_formula.rds
        strata: output/metadata/list_strata.rds
        reweight: output/metadata/reweight_death.rds
        exclude_recentpostest: output/metadata/exclude_recentpostest.rds

  ## #################################### 
  ## over80s 
  ## #################################### 

  extract_over80s:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_over80s
      --output-format csv.gz
    outputs:
      highly_sensitive:
        cohort: output/input_over80s.csv.gz

  data_process_over80s:
    run: r:latest analysis/R/data_process.R over80s
    needs:
    - extract_over80s
    outputs:
      highly_sensitive:
        data: output/over80s/data/data_processed.rds

  data_process_long_over80s:
    run: r:latest analysis/R/data_process_long.R over80s
    needs:
    - data_process_over80s
    outputs:
      highly_sensitive:
        data1: output/over80s/data/data_long_vax_dates.rds
        data2: output/over80s/data/data_long_admission_dates.rds
        data3: output/over80s/data/data_long_admission_infectious_dates.rds
        data4: output/over80s/data/data_long_admission_noninfectious_dates.rds
        data5: output/over80s/data/data_long_pr_probable_covid_dates.rds
        data6: output/over80s/data/data_long_pr_suspected_covid_dates.rds
        data7: output/over80s/data/data_long_postest_dates.rds

  data_properties_over80s:
    run: r:latest analysis/R/data_properties.R output/over80s/data/data_processed.rds
      output/over80s/data_properties
    needs:
    - data_process_over80s
    outputs:
      moderately_sensitive:
        txt: output/over80s/data_properties/data_processed*.txt

  data_selection_over80s:
    run: r:latest analysis/R/data_selection.R over80s
    needs:
    - data_process_over80s
    outputs:
      highly_sensitive:
        cohort: output/over80s/data/data_cohort.rds
      moderately_sensitive:
        flow: output/over80s/data/flowchart.csv

  data_stset_over80s:
    run: r:latest analysis/R/data_stset.R over80s 0.1
    needs:
    - design
    - data_selection_over80s
    - data_process_long_over80s
    outputs:
      highly_sensitive:
        fixed: output/over80s/data/data_fixed.rds
        tte: output/over80s/data/data_tte.rds
        pt: output/over80s/data/data_pt.rds

  data_samples_over80s:
    run: r:latest analysis/R/data_samples.R over80s 0.1
    needs:
    - design
    - data_stset_over80s
    outputs:
      highly_sensitive:
        data: output/over80s/data/data_samples.rds

  check_ethnicity_over80s:
    run: r:latest analysis/R/check_ethnicity.R over80s
    needs:
    - data_process_over80s
    outputs:
      moderately_sensitive:
        tab: output/over80s/data/ethnicity_table*.txt

  descr_table1_over80s:
    run: r:latest analysis/R/descr_table1.R over80s
    needs:
    - design
    - data_selection_over80s
    outputs:
      highly_sensitive:
        rds: output/over80s/descriptive/tables/*.rds
      moderately_sensitive:
        html: output/over80s/descriptive/tables/table1.html

  descr_tableirr_over80s:
    run: r:latest analysis/R/descr_tableirr.R over80s
    needs:
    - design
    - data_selection_over80s
    outputs:
      moderately_sensitive:
        html: output/over80s/descriptive/tables/table_irr.html
        csv: output/over80s/descriptive/tables/table_irr.csv

  descr_events_over80s:
    run: r:latest analysis/R/descr_events.R over80s
    needs:
    - design
    - data_stset_over80s
    outputs:
      highly_sensitive:
        rds: output/over80s/descriptive/plots/*.rds
      moderately_sensitive:
        plots: output/over80s/descriptive/plots/*.svg
        tables: output/over80s/descriptive/tables/*.csv

  descr_preflight_over80s:
    run: r:latest analysis/R/preflight.R over80s all 0.1
    needs:
    - design
    - data_stset_over80s
    outputs:
      moderately_sensitive:
        html: output/over80s/descriptive/model-checks/*.html
        csv: output/over80s/descriptive/model-checks/*.csv

  ## #################################### 
  ## All 
  ## #################################### 

  model_over80s_postest_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest any all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/any/all/*/model*.rds
        data: output/over80s/postest/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/any/all/*/weights*

  report_ipw_over80s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest any all
    needs:
    - design
    - model_over80s_postest_any_all
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/any/all/*/broom*.rds
        gt: output/over80s/postest/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/any/all/*/plot*.svg
        tables: output/over80s/postest/any/all/*/tab*.html
        data: output/over80s/postest/any/all/*/broom*.csv

  report_msm_over80s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest any all
    needs:
    - design
    - model_over80s_postest_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/any/all/forest_plot.svg
        png: output/over80s/postest/any/all/forest_plot.png
        tables: output/over80s/postest/any/all/*.csv

  report_incidence_over80s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest any all
    needs:
    - design
    - model_over80s_postest_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/any/all/*/*.svg
        png: output/over80s/postest/any/all/*/*.png

  model_over80s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest pfizer all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/pfizer/all/*/model*.rds
        data: output/over80s/postest/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/pfizer/all/*/weights*

  report_ipw_over80s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest pfizer all
    needs:
    - design
    - model_over80s_postest_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/pfizer/all/*/broom*.rds
        gt: output/over80s/postest/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/pfizer/all/*/plot*.svg
        tables: output/over80s/postest/pfizer/all/*/tab*.html
        data: output/over80s/postest/pfizer/all/*/broom*.csv

  report_msm_over80s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest pfizer all
    needs:
    - design
    - model_over80s_postest_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/pfizer/all/forest_plot.svg
        png: output/over80s/postest/pfizer/all/forest_plot.png
        tables: output/over80s/postest/pfizer/all/*.csv

  report_incidence_over80s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest pfizer all
    needs:
    - design
    - model_over80s_postest_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/pfizer/all/*/*.svg
        png: output/over80s/postest/pfizer/all/*/*.png

  model_over80s_postest_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest az all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/az/all/*/model*.rds
        data: output/over80s/postest/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/az/all/*/weights*

  report_ipw_over80s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest az all
    needs:
    - design
    - model_over80s_postest_az_all
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/az/all/*/broom*.rds
        gt: output/over80s/postest/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/az/all/*/plot*.svg
        tables: output/over80s/postest/az/all/*/tab*.html
        data: output/over80s/postest/az/all/*/broom*.csv

  report_msm_over80s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest az all
    needs:
    - design
    - model_over80s_postest_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/az/all/forest_plot.svg
        png: output/over80s/postest/az/all/forest_plot.png
        tables: output/over80s/postest/az/all/*.csv

  report_incidence_over80s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest az all
    needs:
    - design
    - model_over80s_postest_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/az/all/*/*.svg
        png: output/over80s/postest/az/all/*/*.png

  model_over80s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted any all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/any/all/*/model*.rds
        data: output/over80s/covidadmitted/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/any/all/*/weights*

  report_ipw_over80s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted any all
    needs:
    - design
    - model_over80s_covidadmitted_any_all
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/any/all/*/broom*.rds
        gt: output/over80s/covidadmitted/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/any/all/*/plot*.svg
        tables: output/over80s/covidadmitted/any/all/*/tab*.html
        data: output/over80s/covidadmitted/any/all/*/broom*.csv

  report_msm_over80s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted any all
    needs:
    - design
    - model_over80s_covidadmitted_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/any/all/forest_plot.svg
        png: output/over80s/covidadmitted/any/all/forest_plot.png
        tables: output/over80s/covidadmitted/any/all/*.csv

  report_incidence_over80s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted any all
    needs:
    - design
    - model_over80s_covidadmitted_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/any/all/*/*.svg
        png: output/over80s/covidadmitted/any/all/*/*.png

  model_over80s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted pfizer all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/pfizer/all/*/model*.rds
        data: output/over80s/covidadmitted/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/pfizer/all/*/weights*

  report_ipw_over80s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted pfizer all
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/pfizer/all/*/broom*.rds
        gt: output/over80s/covidadmitted/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/pfizer/all/*/plot*.svg
        tables: output/over80s/covidadmitted/pfizer/all/*/tab*.html
        data: output/over80s/covidadmitted/pfizer/all/*/broom*.csv

  report_msm_over80s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted pfizer all
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/pfizer/all/forest_plot.svg
        png: output/over80s/covidadmitted/pfizer/all/forest_plot.png
        tables: output/over80s/covidadmitted/pfizer/all/*.csv

  report_incidence_over80s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted pfizer
      all
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/pfizer/all/*/*.svg
        png: output/over80s/covidadmitted/pfizer/all/*/*.png

  model_over80s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted az all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/az/all/*/model*.rds
        data: output/over80s/covidadmitted/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/az/all/*/weights*

  report_ipw_over80s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted az all
    needs:
    - design
    - model_over80s_covidadmitted_az_all
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/az/all/*/broom*.rds
        gt: output/over80s/covidadmitted/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/az/all/*/plot*.svg
        tables: output/over80s/covidadmitted/az/all/*/tab*.html
        data: output/over80s/covidadmitted/az/all/*/broom*.csv

  report_msm_over80s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted az all
    needs:
    - design
    - model_over80s_covidadmitted_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/az/all/forest_plot.svg
        png: output/over80s/covidadmitted/az/all/forest_plot.png
        tables: output/over80s/covidadmitted/az/all/*.csv

  report_incidence_over80s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted az all
    needs:
    - design
    - model_over80s_covidadmitted_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/az/all/*/*.svg
        png: output/over80s/covidadmitted/az/all/*/*.png

  model_over80s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath any all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/any/all/*/model*.rds
        data: output/over80s/coviddeath/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/any/all/*/weights*

  report_ipw_over80s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath any all
    needs:
    - design
    - model_over80s_coviddeath_any_all
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/any/all/*/broom*.rds
        gt: output/over80s/coviddeath/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/any/all/*/plot*.svg
        tables: output/over80s/coviddeath/any/all/*/tab*.html
        data: output/over80s/coviddeath/any/all/*/broom*.csv

  report_msm_over80s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath any all
    needs:
    - design
    - model_over80s_coviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/any/all/forest_plot.svg
        png: output/over80s/coviddeath/any/all/forest_plot.png
        tables: output/over80s/coviddeath/any/all/*.csv

  report_incidence_over80s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath any all
    needs:
    - design
    - model_over80s_coviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/any/all/*/*.svg
        png: output/over80s/coviddeath/any/all/*/*.png

  model_over80s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath pfizer all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/pfizer/all/*/model*.rds
        data: output/over80s/coviddeath/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/pfizer/all/*/weights*

  report_ipw_over80s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath pfizer all
    needs:
    - design
    - model_over80s_coviddeath_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/pfizer/all/*/broom*.rds
        gt: output/over80s/coviddeath/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/pfizer/all/*/plot*.svg
        tables: output/over80s/coviddeath/pfizer/all/*/tab*.html
        data: output/over80s/coviddeath/pfizer/all/*/broom*.csv

  report_msm_over80s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath pfizer all
    needs:
    - design
    - model_over80s_coviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/pfizer/all/forest_plot.svg
        png: output/over80s/coviddeath/pfizer/all/forest_plot.png
        tables: output/over80s/coviddeath/pfizer/all/*.csv

  report_incidence_over80s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath pfizer all
    needs:
    - design
    - model_over80s_coviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/pfizer/all/*/*.svg
        png: output/over80s/coviddeath/pfizer/all/*/*.png

  model_over80s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath az all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/az/all/*/model*.rds
        data: output/over80s/coviddeath/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/az/all/*/weights*

  report_ipw_over80s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath az all
    needs:
    - design
    - model_over80s_coviddeath_az_all
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/az/all/*/broom*.rds
        gt: output/over80s/coviddeath/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/az/all/*/plot*.svg
        tables: output/over80s/coviddeath/az/all/*/tab*.html
        data: output/over80s/coviddeath/az/all/*/broom*.csv

  report_msm_over80s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath az all
    needs:
    - design
    - model_over80s_coviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/az/all/forest_plot.svg
        png: output/over80s/coviddeath/az/all/forest_plot.png
        tables: output/over80s/coviddeath/az/all/*.csv

  report_incidence_over80s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath az all
    needs:
    - design
    - model_over80s_coviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/az/all/*/*.svg
        png: output/over80s/coviddeath/az/all/*/*.png

  model_over80s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath any all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/any/all/*/model*.rds
        data: output/over80s/noncoviddeath/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/any/all/*/weights*

  report_ipw_over80s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath any all
    needs:
    - design
    - model_over80s_noncoviddeath_any_all
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/any/all/*/broom*.rds
        gt: output/over80s/noncoviddeath/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/any/all/*/plot*.svg
        tables: output/over80s/noncoviddeath/any/all/*/tab*.html
        data: output/over80s/noncoviddeath/any/all/*/broom*.csv

  report_msm_over80s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath any all
    needs:
    - design
    - model_over80s_noncoviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/any/all/forest_plot.svg
        png: output/over80s/noncoviddeath/any/all/forest_plot.png
        tables: output/over80s/noncoviddeath/any/all/*.csv

  report_incidence_over80s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath any all
    needs:
    - design
    - model_over80s_noncoviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/any/all/*/*.svg
        png: output/over80s/noncoviddeath/any/all/*/*.png

  model_over80s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath pfizer all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/pfizer/all/*/model*.rds
        data: output/over80s/noncoviddeath/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/pfizer/all/*/weights*

  report_ipw_over80s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath pfizer all
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/pfizer/all/*/broom*.rds
        gt: output/over80s/noncoviddeath/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/pfizer/all/*/plot*.svg
        tables: output/over80s/noncoviddeath/pfizer/all/*/tab*.html
        data: output/over80s/noncoviddeath/pfizer/all/*/broom*.csv

  report_msm_over80s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath pfizer all
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/pfizer/all/forest_plot.svg
        png: output/over80s/noncoviddeath/pfizer/all/forest_plot.png
        tables: output/over80s/noncoviddeath/pfizer/all/*.csv

  report_incidence_over80s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath pfizer
      all
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/pfizer/all/*/*.svg
        png: output/over80s/noncoviddeath/pfizer/all/*/*.png

  model_over80s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath az all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/az/all/*/model*.rds
        data: output/over80s/noncoviddeath/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/az/all/*/weights*

  report_ipw_over80s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath az all
    needs:
    - design
    - model_over80s_noncoviddeath_az_all
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/az/all/*/broom*.rds
        gt: output/over80s/noncoviddeath/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/az/all/*/plot*.svg
        tables: output/over80s/noncoviddeath/az/all/*/tab*.html
        data: output/over80s/noncoviddeath/az/all/*/broom*.csv

  report_msm_over80s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath az all
    needs:
    - design
    - model_over80s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/az/all/forest_plot.svg
        png: output/over80s/noncoviddeath/az/all/forest_plot.png
        tables: output/over80s/noncoviddeath/az/all/*.csv

  report_incidence_over80s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath az all
    needs:
    - design
    - model_over80s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/az/all/*/*.svg
        png: output/over80s/noncoviddeath/az/all/*/*.png

  model_over80s_death_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death any all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/any/all/*/model*.rds
        data: output/over80s/death/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/any/all/*/weights*

  report_ipw_over80s_death_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death any all
    needs:
    - design
    - model_over80s_death_any_all
    outputs:
      highly_sensitive:
        broom: output/over80s/death/any/all/*/broom*.rds
        gt: output/over80s/death/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/any/all/*/plot*.svg
        tables: output/over80s/death/any/all/*/tab*.html
        data: output/over80s/death/any/all/*/broom*.csv

  report_msm_over80s_death_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death any all
    needs:
    - design
    - model_over80s_death_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/any/all/forest_plot.svg
        png: output/over80s/death/any/all/forest_plot.png
        tables: output/over80s/death/any/all/*.csv

  report_incidence_over80s_death_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death any all
    needs:
    - design
    - model_over80s_death_any_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/any/all/*/*.svg
        png: output/over80s/death/any/all/*/*.png

  model_over80s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death pfizer all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/pfizer/all/*/model*.rds
        data: output/over80s/death/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/pfizer/all/*/weights*

  report_ipw_over80s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death pfizer all
    needs:
    - design
    - model_over80s_death_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/over80s/death/pfizer/all/*/broom*.rds
        gt: output/over80s/death/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/pfizer/all/*/plot*.svg
        tables: output/over80s/death/pfizer/all/*/tab*.html
        data: output/over80s/death/pfizer/all/*/broom*.csv

  report_msm_over80s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death pfizer all
    needs:
    - design
    - model_over80s_death_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/pfizer/all/forest_plot.svg
        png: output/over80s/death/pfizer/all/forest_plot.png
        tables: output/over80s/death/pfizer/all/*.csv

  report_incidence_over80s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death pfizer all
    needs:
    - design
    - model_over80s_death_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/pfizer/all/*/*.svg
        png: output/over80s/death/pfizer/all/*/*.png

  model_over80s_death_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death az all
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/az/all/*/model*.rds
        data: output/over80s/death/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/az/all/*/weights*

  report_ipw_over80s_death_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death az all
    needs:
    - design
    - model_over80s_death_az_all
    outputs:
      highly_sensitive:
        broom: output/over80s/death/az/all/*/broom*.rds
        gt: output/over80s/death/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/az/all/*/plot*.svg
        tables: output/over80s/death/az/all/*/tab*.html
        data: output/over80s/death/az/all/*/broom*.csv

  report_msm_over80s_death_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death az all
    needs:
    - design
    - model_over80s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/az/all/forest_plot.svg
        png: output/over80s/death/az/all/forest_plot.png
        tables: output/over80s/death/az/all/*.csv

  report_incidence_over80s_death_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death az all
    needs:
    - design
    - model_over80s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/az/all/*/*.svg
        png: output/over80s/death/az/all/*/*.png

  report_ipw_over80s_all:
    run: r:latest analysis/R/dose_1/report_vaxmodel.R over80s death all
    needs:
    - design
    - report_ipw_over80s_death_any_all
    - report_ipw_over80s_death_pfizer_all
    - report_ipw_over80s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/plot_vax1.svg
        csv: output/over80s/tab_vax1.csv
        csv_wide: output/over80s/tab_vax1_wide.csv

  report_over80s_all:
    run: r:latest analysis/R/dose_1/report_msm_combined.R over80s all
    needs:
    - design
    - report_msm_over80s_postest_any_all
    - report_msm_over80s_postest_pfizer_all
    - report_msm_over80s_postest_az_all
    - report_msm_over80s_covidadmitted_any_all
    - report_msm_over80s_covidadmitted_pfizer_all
    - report_msm_over80s_covidadmitted_az_all
    - report_msm_over80s_coviddeath_any_all
    - report_msm_over80s_coviddeath_pfizer_all
    - report_msm_over80s_coviddeath_az_all
    - report_msm_over80s_noncoviddeath_any_all
    - report_msm_over80s_noncoviddeath_pfizer_all
    - report_msm_over80s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/over80s/combined/all/*.svg
        png: output/over80s/combined/all/*.png
        csv: output/over80s/combined/all/*.csv

  ## #################################### 
  ## Immunosuppressed 
  ## #################################### 

  model_over80s_postest_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest any any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/any/any_immunosuppression/*/model*.rds
        data: output/over80s/postest/any/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/any/any_immunosuppression/*/weights*

  report_ipw_over80s_postest_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest any any_immunosuppression
    needs:
    - design
    - model_over80s_postest_any_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/any/any_immunosuppression/*/broom*.rds
        gt: output/over80s/postest/any/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/any/any_immunosuppression/*/plot*.svg
        tables: output/over80s/postest/any/any_immunosuppression/*/tab*.html
        data: output/over80s/postest/any/any_immunosuppression/*/broom*.csv

  report_msm_over80s_postest_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest any any_immunosuppression
    needs:
    - design
    - model_over80s_postest_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/any/any_immunosuppression/forest_plot.svg
        png: output/over80s/postest/any/any_immunosuppression/forest_plot.png
        tables: output/over80s/postest/any/any_immunosuppression/*.csv

  report_incidence_over80s_postest_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest any any_immunosuppression
    needs:
    - design
    - model_over80s_postest_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/any/any_immunosuppression/*/*.svg
        png: output/over80s/postest/any/any_immunosuppression/*/*.png

  model_over80s_postest_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest pfizer any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/pfizer/any_immunosuppression/*/model*.rds
        data: output/over80s/postest/pfizer/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/pfizer/any_immunosuppression/*/weights*

  report_ipw_over80s_postest_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_postest_pfizer_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/pfizer/any_immunosuppression/*/broom*.rds
        gt: output/over80s/postest/pfizer/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/pfizer/any_immunosuppression/*/plot*.svg
        tables: output/over80s/postest/pfizer/any_immunosuppression/*/tab*.html
        data: output/over80s/postest/pfizer/any_immunosuppression/*/broom*.csv

  report_msm_over80s_postest_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_postest_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/pfizer/any_immunosuppression/forest_plot.svg
        png: output/over80s/postest/pfizer/any_immunosuppression/forest_plot.png
        tables: output/over80s/postest/pfizer/any_immunosuppression/*.csv

  report_incidence_over80s_postest_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_postest_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/pfizer/any_immunosuppression/*/*.svg
        png: output/over80s/postest/pfizer/any_immunosuppression/*/*.png

  model_over80s_postest_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s postest az any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/postest/az/any_immunosuppression/*/model*.rds
        data: output/over80s/postest/az/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/postest/az/any_immunosuppression/*/weights*

  report_ipw_over80s_postest_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s postest az any_immunosuppression
    needs:
    - design
    - model_over80s_postest_az_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/postest/az/any_immunosuppression/*/broom*.rds
        gt: output/over80s/postest/az/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/postest/az/any_immunosuppression/*/plot*.svg
        tables: output/over80s/postest/az/any_immunosuppression/*/tab*.html
        data: output/over80s/postest/az/any_immunosuppression/*/broom*.csv

  report_msm_over80s_postest_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s postest az any_immunosuppression
    needs:
    - design
    - model_over80s_postest_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/az/any_immunosuppression/forest_plot.svg
        png: output/over80s/postest/az/any_immunosuppression/forest_plot.png
        tables: output/over80s/postest/az/any_immunosuppression/*.csv

  report_incidence_over80s_postest_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s postest az any_immunosuppression
    needs:
    - design
    - model_over80s_postest_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/postest/az/any_immunosuppression/*/*.svg
        png: output/over80s/postest/az/any_immunosuppression/*/*.png

  model_over80s_covidadmitted_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted any any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/any/any_immunosuppression/*/model*.rds
        data: output/over80s/covidadmitted/any/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/any/any_immunosuppression/*/weights*

  report_ipw_over80s_covidadmitted_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted any any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_any_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/any/any_immunosuppression/*/broom*.rds
        gt: output/over80s/covidadmitted/any/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/any/any_immunosuppression/*/plot*.svg
        tables: output/over80s/covidadmitted/any/any_immunosuppression/*/tab*.html
        data: output/over80s/covidadmitted/any/any_immunosuppression/*/broom*.csv

  report_msm_over80s_covidadmitted_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted any any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/any/any_immunosuppression/forest_plot.svg
        png: output/over80s/covidadmitted/any/any_immunosuppression/forest_plot.png
        tables: output/over80s/covidadmitted/any/any_immunosuppression/*.csv

  report_incidence_over80s_covidadmitted_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted any any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/any/any_immunosuppression/*/*.svg
        png: output/over80s/covidadmitted/any/any_immunosuppression/*/*.png

  model_over80s_covidadmitted_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted pfizer any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/model*.rds
        data: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/weights*

  report_ipw_over80s_covidadmitted_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/broom*.rds
        gt: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/plot*.svg
        tables: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/tab*.html
        data: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/broom*.csv

  report_msm_over80s_covidadmitted_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/pfizer/any_immunosuppression/forest_plot.svg
        png: output/over80s/covidadmitted/pfizer/any_immunosuppression/forest_plot.png
        tables: output/over80s/covidadmitted/pfizer/any_immunosuppression/*.csv

  report_incidence_over80s_covidadmitted_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted pfizer
      any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/*.svg
        png: output/over80s/covidadmitted/pfizer/any_immunosuppression/*/*.png

  model_over80s_covidadmitted_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s covidadmitted az any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/covidadmitted/az/any_immunosuppression/*/model*.rds
        data: output/over80s/covidadmitted/az/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/covidadmitted/az/any_immunosuppression/*/weights*

  report_ipw_over80s_covidadmitted_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s covidadmitted az any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_az_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/covidadmitted/az/any_immunosuppression/*/broom*.rds
        gt: output/over80s/covidadmitted/az/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/covidadmitted/az/any_immunosuppression/*/plot*.svg
        tables: output/over80s/covidadmitted/az/any_immunosuppression/*/tab*.html
        data: output/over80s/covidadmitted/az/any_immunosuppression/*/broom*.csv

  report_msm_over80s_covidadmitted_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s covidadmitted az any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/az/any_immunosuppression/forest_plot.svg
        png: output/over80s/covidadmitted/az/any_immunosuppression/forest_plot.png
        tables: output/over80s/covidadmitted/az/any_immunosuppression/*.csv

  report_incidence_over80s_covidadmitted_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s covidadmitted az any_immunosuppression
    needs:
    - design
    - model_over80s_covidadmitted_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/covidadmitted/az/any_immunosuppression/*/*.svg
        png: output/over80s/covidadmitted/az/any_immunosuppression/*/*.png

  model_over80s_coviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath any any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/any/any_immunosuppression/*/model*.rds
        data: output/over80s/coviddeath/any/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/any/any_immunosuppression/*/weights*

  report_ipw_over80s_coviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_any_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/any/any_immunosuppression/*/broom*.rds
        gt: output/over80s/coviddeath/any/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/any/any_immunosuppression/*/plot*.svg
        tables: output/over80s/coviddeath/any/any_immunosuppression/*/tab*.html
        data: output/over80s/coviddeath/any/any_immunosuppression/*/broom*.csv

  report_msm_over80s_coviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/any/any_immunosuppression/forest_plot.svg
        png: output/over80s/coviddeath/any/any_immunosuppression/forest_plot.png
        tables: output/over80s/coviddeath/any/any_immunosuppression/*.csv

  report_incidence_over80s_coviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/any/any_immunosuppression/*/*.svg
        png: output/over80s/coviddeath/any/any_immunosuppression/*/*.png

  model_over80s_coviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath pfizer any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/pfizer/any_immunosuppression/*/model*.rds
        data: output/over80s/coviddeath/pfizer/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/pfizer/any_immunosuppression/*/weights*

  report_ipw_over80s_coviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_pfizer_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/pfizer/any_immunosuppression/*/broom*.rds
        gt: output/over80s/coviddeath/pfizer/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/pfizer/any_immunosuppression/*/plot*.svg
        tables: output/over80s/coviddeath/pfizer/any_immunosuppression/*/tab*.html
        data: output/over80s/coviddeath/pfizer/any_immunosuppression/*/broom*.csv

  report_msm_over80s_coviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/pfizer/any_immunosuppression/forest_plot.svg
        png: output/over80s/coviddeath/pfizer/any_immunosuppression/forest_plot.png
        tables: output/over80s/coviddeath/pfizer/any_immunosuppression/*.csv

  report_incidence_over80s_coviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/pfizer/any_immunosuppression/*/*.svg
        png: output/over80s/coviddeath/pfizer/any_immunosuppression/*/*.png

  model_over80s_coviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s coviddeath az any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/coviddeath/az/any_immunosuppression/*/model*.rds
        data: output/over80s/coviddeath/az/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/coviddeath/az/any_immunosuppression/*/weights*

  report_ipw_over80s_coviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s coviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_az_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/coviddeath/az/any_immunosuppression/*/broom*.rds
        gt: output/over80s/coviddeath/az/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/coviddeath/az/any_immunosuppression/*/plot*.svg
        tables: output/over80s/coviddeath/az/any_immunosuppression/*/tab*.html
        data: output/over80s/coviddeath/az/any_immunosuppression/*/broom*.csv

  report_msm_over80s_coviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s coviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/az/any_immunosuppression/forest_plot.svg
        png: output/over80s/coviddeath/az/any_immunosuppression/forest_plot.png
        tables: output/over80s/coviddeath/az/any_immunosuppression/*.csv

  report_incidence_over80s_coviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s coviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_coviddeath_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/coviddeath/az/any_immunosuppression/*/*.svg
        png: output/over80s/coviddeath/az/any_immunosuppression/*/*.png

  model_over80s_noncoviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath any any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/any/any_immunosuppression/*/model*.rds
        data: output/over80s/noncoviddeath/any/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/any/any_immunosuppression/*/weights*

  report_ipw_over80s_noncoviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_any_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/any/any_immunosuppression/*/broom*.rds
        gt: output/over80s/noncoviddeath/any/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/any/any_immunosuppression/*/plot*.svg
        tables: output/over80s/noncoviddeath/any/any_immunosuppression/*/tab*.html
        data: output/over80s/noncoviddeath/any/any_immunosuppression/*/broom*.csv

  report_msm_over80s_noncoviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/any/any_immunosuppression/forest_plot.svg
        png: output/over80s/noncoviddeath/any/any_immunosuppression/forest_plot.png
        tables: output/over80s/noncoviddeath/any/any_immunosuppression/*.csv

  report_incidence_over80s_noncoviddeath_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath any any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/any/any_immunosuppression/*/*.svg
        png: output/over80s/noncoviddeath/any/any_immunosuppression/*/*.png

  model_over80s_noncoviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath pfizer any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/model*.rds
        data: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/weights*

  report_ipw_over80s_noncoviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/broom*.rds
        gt: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/plot*.svg
        tables: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/tab*.html
        data: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/broom*.csv

  report_msm_over80s_noncoviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/pfizer/any_immunosuppression/forest_plot.svg
        png: output/over80s/noncoviddeath/pfizer/any_immunosuppression/forest_plot.png
        tables: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*.csv

  report_incidence_over80s_noncoviddeath_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath pfizer
      any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/*.svg
        png: output/over80s/noncoviddeath/pfizer/any_immunosuppression/*/*.png

  model_over80s_noncoviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s noncoviddeath az any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/noncoviddeath/az/any_immunosuppression/*/model*.rds
        data: output/over80s/noncoviddeath/az/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/noncoviddeath/az/any_immunosuppression/*/weights*

  report_ipw_over80s_noncoviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s noncoviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_az_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/noncoviddeath/az/any_immunosuppression/*/broom*.rds
        gt: output/over80s/noncoviddeath/az/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/noncoviddeath/az/any_immunosuppression/*/plot*.svg
        tables: output/over80s/noncoviddeath/az/any_immunosuppression/*/tab*.html
        data: output/over80s/noncoviddeath/az/any_immunosuppression/*/broom*.csv

  report_msm_over80s_noncoviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s noncoviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/az/any_immunosuppression/forest_plot.svg
        png: output/over80s/noncoviddeath/az/any_immunosuppression/forest_plot.png
        tables: output/over80s/noncoviddeath/az/any_immunosuppression/*.csv

  report_incidence_over80s_noncoviddeath_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s noncoviddeath az any_immunosuppression
    needs:
    - design
    - model_over80s_noncoviddeath_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/noncoviddeath/az/any_immunosuppression/*/*.svg
        png: output/over80s/noncoviddeath/az/any_immunosuppression/*/*.png

  model_over80s_death_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death any any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/any/any_immunosuppression/*/model*.rds
        data: output/over80s/death/any/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/any/any_immunosuppression/*/weights*

  report_ipw_over80s_death_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death any any_immunosuppression
    needs:
    - design
    - model_over80s_death_any_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/death/any/any_immunosuppression/*/broom*.rds
        gt: output/over80s/death/any/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/any/any_immunosuppression/*/plot*.svg
        tables: output/over80s/death/any/any_immunosuppression/*/tab*.html
        data: output/over80s/death/any/any_immunosuppression/*/broom*.csv

  report_msm_over80s_death_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death any any_immunosuppression
    needs:
    - design
    - model_over80s_death_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/any/any_immunosuppression/forest_plot.svg
        png: output/over80s/death/any/any_immunosuppression/forest_plot.png
        tables: output/over80s/death/any/any_immunosuppression/*.csv

  report_incidence_over80s_death_any_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death any any_immunosuppression
    needs:
    - design
    - model_over80s_death_any_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/any/any_immunosuppression/*/*.svg
        png: output/over80s/death/any/any_immunosuppression/*/*.png

  model_over80s_death_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death pfizer any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/pfizer/any_immunosuppression/*/model*.rds
        data: output/over80s/death/pfizer/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/pfizer/any_immunosuppression/*/weights*

  report_ipw_over80s_death_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_death_pfizer_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/death/pfizer/any_immunosuppression/*/broom*.rds
        gt: output/over80s/death/pfizer/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/pfizer/any_immunosuppression/*/plot*.svg
        tables: output/over80s/death/pfizer/any_immunosuppression/*/tab*.html
        data: output/over80s/death/pfizer/any_immunosuppression/*/broom*.csv

  report_msm_over80s_death_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_death_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/pfizer/any_immunosuppression/forest_plot.svg
        png: output/over80s/death/pfizer/any_immunosuppression/forest_plot.png
        tables: output/over80s/death/pfizer/any_immunosuppression/*.csv

  report_incidence_over80s_death_pfizer_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death pfizer any_immunosuppression
    needs:
    - design
    - model_over80s_death_pfizer_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/pfizer/any_immunosuppression/*/*.svg
        png: output/over80s/death/pfizer/any_immunosuppression/*/*.png

  model_over80s_death_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/model_msm.R over80s death az any_immunosuppression
    needs:
    - design
    - data_stset_over80s
    - data_samples_over80s
    outputs:
      highly_sensitive:
        models: output/over80s/death/az/any_immunosuppression/*/model*.rds
        data: output/over80s/death/az/any_immunosuppression/*/data*.rds
      moderately_sensitive:
        weights: output/over80s/death/az/any_immunosuppression/*/weights*

  report_ipw_over80s_death_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_ipw.R over80s death az any_immunosuppression
    needs:
    - design
    - model_over80s_death_az_any_immunosuppression
    outputs:
      highly_sensitive:
        broom: output/over80s/death/az/any_immunosuppression/*/broom*.rds
        gt: output/over80s/death/az/any_immunosuppression/*/gt*.rds
      moderately_sensitive:
        plots: output/over80s/death/az/any_immunosuppression/*/plot*.svg
        tables: output/over80s/death/az/any_immunosuppression/*/tab*.html
        data: output/over80s/death/az/any_immunosuppression/*/broom*.csv

  report_msm_over80s_death_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm.R over80s death az any_immunosuppression
    needs:
    - design
    - model_over80s_death_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/az/any_immunosuppression/forest_plot.svg
        png: output/over80s/death/az/any_immunosuppression/forest_plot.png
        tables: output/over80s/death/az/any_immunosuppression/*.csv

  report_incidence_over80s_death_az_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_incidence.R over80s death az any_immunosuppression
    needs:
    - design
    - model_over80s_death_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/death/az/any_immunosuppression/*/*.svg
        png: output/over80s/death/az/any_immunosuppression/*/*.png

  report_ipw_over80s_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_vaxmodel.R over80s death any_immunosuppression
    needs:
    - design
    - report_ipw_over80s_death_any_any_immunosuppression
    - report_ipw_over80s_death_pfizer_any_immunosuppression
    - report_ipw_over80s_death_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/plot_vax1.svg
        csv: output/over80s/tab_vax1.csv
        csv_wide: output/over80s/tab_vax1_wide.csv

  report_over80s_any_immunosuppression:
    run: r:latest analysis/R/dose_1/report_msm_combined.R over80s any_immunosuppression
    needs:
    - design
    - report_msm_over80s_postest_any_any_immunosuppression
    - report_msm_over80s_postest_pfizer_any_immunosuppression
    - report_msm_over80s_postest_az_any_immunosuppression
    - report_msm_over80s_covidadmitted_any_any_immunosuppression
    - report_msm_over80s_covidadmitted_pfizer_any_immunosuppression
    - report_msm_over80s_covidadmitted_az_any_immunosuppression
    - report_msm_over80s_coviddeath_any_any_immunosuppression
    - report_msm_over80s_coviddeath_pfizer_any_immunosuppression
    - report_msm_over80s_coviddeath_az_any_immunosuppression
    - report_msm_over80s_noncoviddeath_any_any_immunosuppression
    - report_msm_over80s_noncoviddeath_pfizer_any_immunosuppression
    - report_msm_over80s_noncoviddeath_az_any_immunosuppression
    outputs:
      moderately_sensitive:
        svg: output/over80s/combined/any_immunosuppression/*.svg
        png: output/over80s/combined/any_immunosuppression/*.png
        csv: output/over80s/combined/any_immunosuppression/*.csv

  ## #################################### 
  ## in70s, all 
  ## #################################### 

  extract_in70s:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_in70s
      --output-format csv.gz
    outputs:
      highly_sensitive:
        cohort: output/input_in70s.csv.gz

  data_process_in70s:
    run: r:latest analysis/R/data_process.R in70s
    needs:
    - extract_in70s
    outputs:
      highly_sensitive:
        data: output/in70s/data/data_processed.rds

  data_process_long_in70s:
    run: r:latest analysis/R/data_process_long.R in70s
    needs:
    - data_process_in70s
    outputs:
      highly_sensitive:
        data1: output/in70s/data/data_long_vax_dates.rds
        data2: output/in70s/data/data_long_admission_dates.rds
        data3: output/in70s/data/data_long_admission_infectious_dates.rds
        data4: output/in70s/data/data_long_admission_noninfectious_dates.rds
        data5: output/in70s/data/data_long_pr_probable_covid_dates.rds
        data6: output/in70s/data/data_long_pr_suspected_covid_dates.rds
        data7: output/in70s/data/data_long_postest_dates.rds

  data_properties_in70s:
    run: r:latest analysis/R/data_properties.R output/in70s/data/data_processed.rds
      output/in70s/data_properties
    needs:
    - data_process_in70s
    outputs:
      moderately_sensitive:
        txt: output/in70s/data_properties/data_processed*.txt

  data_selection_in70s:
    run: r:latest analysis/R/data_selection.R in70s
    needs:
    - data_process_in70s
    outputs:
      highly_sensitive:
        cohort: output/in70s/data/data_cohort.rds
      moderately_sensitive:
        flow: output/in70s/data/flowchart.csv

  data_stset_in70s:
    run: r:latest analysis/R/data_stset.R in70s 0.1
    needs:
    - design
    - data_selection_in70s
    - data_process_long_in70s
    outputs:
      highly_sensitive:
        fixed: output/in70s/data/data_fixed.rds
        tte: output/in70s/data/data_tte.rds
        pt: output/in70s/data/data_pt.rds

  data_samples_in70s:
    run: r:latest analysis/R/data_samples.R in70s 0.1
    needs:
    - design
    - data_stset_in70s
    outputs:
      highly_sensitive:
        data: output/in70s/data/data_samples.rds

  check_ethnicity_in70s:
    run: r:latest analysis/R/check_ethnicity.R in70s
    needs:
    - data_process_in70s
    outputs:
      moderately_sensitive:
        tab: output/in70s/data/ethnicity_table*.txt

  descr_table1_in70s:
    run: r:latest analysis/R/descr_table1.R in70s
    needs:
    - design
    - data_selection_in70s
    outputs:
      highly_sensitive:
        rds: output/in70s/descriptive/tables/*.rds
      moderately_sensitive:
        html: output/in70s/descriptive/tables/table1.html

  descr_tableirr_in70s:
    run: r:latest analysis/R/descr_tableirr.R in70s
    needs:
    - design
    - data_selection_in70s
    outputs:
      moderately_sensitive:
        html: output/in70s/descriptive/tables/table_irr.html
        csv: output/in70s/descriptive/tables/table_irr.csv

  descr_events_in70s:
    run: r:latest analysis/R/descr_events.R in70s
    needs:
    - design
    - data_stset_in70s
    outputs:
      highly_sensitive:
        rds: output/in70s/descriptive/plots/*.rds
      moderately_sensitive:
        plots: output/in70s/descriptive/plots/*.svg
        tables: output/in70s/descriptive/tables/*.csv

  model_in70s_postest_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s postest any all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/postest/any/all/*/model*.rds
        data: output/in70s/postest/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/postest/any/all/*/weights*

  report_ipw_in70s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s postest any all
    needs:
    - design
    - model_in70s_postest_any_all
    outputs:
      highly_sensitive:
        broom: output/in70s/postest/any/all/*/broom*.rds
        gt: output/in70s/postest/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/postest/any/all/*/plot*.svg
        tables: output/in70s/postest/any/all/*/tab*.html
        data: output/in70s/postest/any/all/*/broom*.csv

  report_msm_in70s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s postest any all
    needs:
    - design
    - model_in70s_postest_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/any/all/forest_plot.svg
        png: output/in70s/postest/any/all/forest_plot.png
        tables: output/in70s/postest/any/all/*.csv

  report_incidence_in70s_postest_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s postest any all
    needs:
    - design
    - model_in70s_postest_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/any/all/*/*.svg
        png: output/in70s/postest/any/all/*/*.png

  model_in70s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s postest pfizer all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/postest/pfizer/all/*/model*.rds
        data: output/in70s/postest/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/postest/pfizer/all/*/weights*

  report_ipw_in70s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s postest pfizer all
    needs:
    - design
    - model_in70s_postest_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/in70s/postest/pfizer/all/*/broom*.rds
        gt: output/in70s/postest/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/postest/pfizer/all/*/plot*.svg
        tables: output/in70s/postest/pfizer/all/*/tab*.html
        data: output/in70s/postest/pfizer/all/*/broom*.csv

  report_msm_in70s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s postest pfizer all
    needs:
    - design
    - model_in70s_postest_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/pfizer/all/forest_plot.svg
        png: output/in70s/postest/pfizer/all/forest_plot.png
        tables: output/in70s/postest/pfizer/all/*.csv

  report_incidence_in70s_postest_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s postest pfizer all
    needs:
    - design
    - model_in70s_postest_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/pfizer/all/*/*.svg
        png: output/in70s/postest/pfizer/all/*/*.png

  model_in70s_postest_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s postest az all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/postest/az/all/*/model*.rds
        data: output/in70s/postest/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/postest/az/all/*/weights*

  report_ipw_in70s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s postest az all
    needs:
    - design
    - model_in70s_postest_az_all
    outputs:
      highly_sensitive:
        broom: output/in70s/postest/az/all/*/broom*.rds
        gt: output/in70s/postest/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/postest/az/all/*/plot*.svg
        tables: output/in70s/postest/az/all/*/tab*.html
        data: output/in70s/postest/az/all/*/broom*.csv

  report_msm_in70s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s postest az all
    needs:
    - design
    - model_in70s_postest_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/az/all/forest_plot.svg
        png: output/in70s/postest/az/all/forest_plot.png
        tables: output/in70s/postest/az/all/*.csv

  report_incidence_in70s_postest_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s postest az all
    needs:
    - design
    - model_in70s_postest_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/postest/az/all/*/*.svg
        png: output/in70s/postest/az/all/*/*.png

  model_in70s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s covidadmitted any all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/covidadmitted/any/all/*/model*.rds
        data: output/in70s/covidadmitted/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/covidadmitted/any/all/*/weights*

  report_ipw_in70s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s covidadmitted any all
    needs:
    - design
    - model_in70s_covidadmitted_any_all
    outputs:
      highly_sensitive:
        broom: output/in70s/covidadmitted/any/all/*/broom*.rds
        gt: output/in70s/covidadmitted/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/covidadmitted/any/all/*/plot*.svg
        tables: output/in70s/covidadmitted/any/all/*/tab*.html
        data: output/in70s/covidadmitted/any/all/*/broom*.csv

  report_msm_in70s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s covidadmitted any all
    needs:
    - design
    - model_in70s_covidadmitted_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/any/all/forest_plot.svg
        png: output/in70s/covidadmitted/any/all/forest_plot.png
        tables: output/in70s/covidadmitted/any/all/*.csv

  report_incidence_in70s_covidadmitted_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s covidadmitted any all
    needs:
    - design
    - model_in70s_covidadmitted_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/any/all/*/*.svg
        png: output/in70s/covidadmitted/any/all/*/*.png

  model_in70s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s covidadmitted pfizer all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/covidadmitted/pfizer/all/*/model*.rds
        data: output/in70s/covidadmitted/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/covidadmitted/pfizer/all/*/weights*

  report_ipw_in70s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s covidadmitted pfizer all
    needs:
    - design
    - model_in70s_covidadmitted_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/in70s/covidadmitted/pfizer/all/*/broom*.rds
        gt: output/in70s/covidadmitted/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/covidadmitted/pfizer/all/*/plot*.svg
        tables: output/in70s/covidadmitted/pfizer/all/*/tab*.html
        data: output/in70s/covidadmitted/pfizer/all/*/broom*.csv

  report_msm_in70s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s covidadmitted pfizer all
    needs:
    - design
    - model_in70s_covidadmitted_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/pfizer/all/forest_plot.svg
        png: output/in70s/covidadmitted/pfizer/all/forest_plot.png
        tables: output/in70s/covidadmitted/pfizer/all/*.csv

  report_incidence_in70s_covidadmitted_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s covidadmitted pfizer
      all
    needs:
    - design
    - model_in70s_covidadmitted_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/pfizer/all/*/*.svg
        png: output/in70s/covidadmitted/pfizer/all/*/*.png

  model_in70s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s covidadmitted az all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/covidadmitted/az/all/*/model*.rds
        data: output/in70s/covidadmitted/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/covidadmitted/az/all/*/weights*

  report_ipw_in70s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s covidadmitted az all
    needs:
    - design
    - model_in70s_covidadmitted_az_all
    outputs:
      highly_sensitive:
        broom: output/in70s/covidadmitted/az/all/*/broom*.rds
        gt: output/in70s/covidadmitted/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/covidadmitted/az/all/*/plot*.svg
        tables: output/in70s/covidadmitted/az/all/*/tab*.html
        data: output/in70s/covidadmitted/az/all/*/broom*.csv

  report_msm_in70s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s covidadmitted az all
    needs:
    - design
    - model_in70s_covidadmitted_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/az/all/forest_plot.svg
        png: output/in70s/covidadmitted/az/all/forest_plot.png
        tables: output/in70s/covidadmitted/az/all/*.csv

  report_incidence_in70s_covidadmitted_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s covidadmitted az all
    needs:
    - design
    - model_in70s_covidadmitted_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/covidadmitted/az/all/*/*.svg
        png: output/in70s/covidadmitted/az/all/*/*.png

  model_in70s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s coviddeath any all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/coviddeath/any/all/*/model*.rds
        data: output/in70s/coviddeath/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/coviddeath/any/all/*/weights*

  report_ipw_in70s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s coviddeath any all
    needs:
    - design
    - model_in70s_coviddeath_any_all
    outputs:
      highly_sensitive:
        broom: output/in70s/coviddeath/any/all/*/broom*.rds
        gt: output/in70s/coviddeath/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/coviddeath/any/all/*/plot*.svg
        tables: output/in70s/coviddeath/any/all/*/tab*.html
        data: output/in70s/coviddeath/any/all/*/broom*.csv

  report_msm_in70s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s coviddeath any all
    needs:
    - design
    - model_in70s_coviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/any/all/forest_plot.svg
        png: output/in70s/coviddeath/any/all/forest_plot.png
        tables: output/in70s/coviddeath/any/all/*.csv

  report_incidence_in70s_coviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s coviddeath any all
    needs:
    - design
    - model_in70s_coviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/any/all/*/*.svg
        png: output/in70s/coviddeath/any/all/*/*.png

  model_in70s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s coviddeath pfizer all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/coviddeath/pfizer/all/*/model*.rds
        data: output/in70s/coviddeath/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/coviddeath/pfizer/all/*/weights*

  report_ipw_in70s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s coviddeath pfizer all
    needs:
    - design
    - model_in70s_coviddeath_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/in70s/coviddeath/pfizer/all/*/broom*.rds
        gt: output/in70s/coviddeath/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/coviddeath/pfizer/all/*/plot*.svg
        tables: output/in70s/coviddeath/pfizer/all/*/tab*.html
        data: output/in70s/coviddeath/pfizer/all/*/broom*.csv

  report_msm_in70s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s coviddeath pfizer all
    needs:
    - design
    - model_in70s_coviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/pfizer/all/forest_plot.svg
        png: output/in70s/coviddeath/pfizer/all/forest_plot.png
        tables: output/in70s/coviddeath/pfizer/all/*.csv

  report_incidence_in70s_coviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s coviddeath pfizer all
    needs:
    - design
    - model_in70s_coviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/pfizer/all/*/*.svg
        png: output/in70s/coviddeath/pfizer/all/*/*.png

  model_in70s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s coviddeath az all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/coviddeath/az/all/*/model*.rds
        data: output/in70s/coviddeath/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/coviddeath/az/all/*/weights*

  report_ipw_in70s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s coviddeath az all
    needs:
    - design
    - model_in70s_coviddeath_az_all
    outputs:
      highly_sensitive:
        broom: output/in70s/coviddeath/az/all/*/broom*.rds
        gt: output/in70s/coviddeath/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/coviddeath/az/all/*/plot*.svg
        tables: output/in70s/coviddeath/az/all/*/tab*.html
        data: output/in70s/coviddeath/az/all/*/broom*.csv

  report_msm_in70s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s coviddeath az all
    needs:
    - design
    - model_in70s_coviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/az/all/forest_plot.svg
        png: output/in70s/coviddeath/az/all/forest_plot.png
        tables: output/in70s/coviddeath/az/all/*.csv

  report_incidence_in70s_coviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s coviddeath az all
    needs:
    - design
    - model_in70s_coviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/coviddeath/az/all/*/*.svg
        png: output/in70s/coviddeath/az/all/*/*.png

  model_in70s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s noncoviddeath any all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/noncoviddeath/any/all/*/model*.rds
        data: output/in70s/noncoviddeath/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/noncoviddeath/any/all/*/weights*

  report_ipw_in70s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s noncoviddeath any all
    needs:
    - design
    - model_in70s_noncoviddeath_any_all
    outputs:
      highly_sensitive:
        broom: output/in70s/noncoviddeath/any/all/*/broom*.rds
        gt: output/in70s/noncoviddeath/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/noncoviddeath/any/all/*/plot*.svg
        tables: output/in70s/noncoviddeath/any/all/*/tab*.html
        data: output/in70s/noncoviddeath/any/all/*/broom*.csv

  report_msm_in70s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s noncoviddeath any all
    needs:
    - design
    - model_in70s_noncoviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/any/all/forest_plot.svg
        png: output/in70s/noncoviddeath/any/all/forest_plot.png
        tables: output/in70s/noncoviddeath/any/all/*.csv

  report_incidence_in70s_noncoviddeath_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s noncoviddeath any all
    needs:
    - design
    - model_in70s_noncoviddeath_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/any/all/*/*.svg
        png: output/in70s/noncoviddeath/any/all/*/*.png

  model_in70s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s noncoviddeath pfizer all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/noncoviddeath/pfizer/all/*/model*.rds
        data: output/in70s/noncoviddeath/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/noncoviddeath/pfizer/all/*/weights*

  report_ipw_in70s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s noncoviddeath pfizer all
    needs:
    - design
    - model_in70s_noncoviddeath_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/in70s/noncoviddeath/pfizer/all/*/broom*.rds
        gt: output/in70s/noncoviddeath/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/noncoviddeath/pfizer/all/*/plot*.svg
        tables: output/in70s/noncoviddeath/pfizer/all/*/tab*.html
        data: output/in70s/noncoviddeath/pfizer/all/*/broom*.csv

  report_msm_in70s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s noncoviddeath pfizer all
    needs:
    - design
    - model_in70s_noncoviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/pfizer/all/forest_plot.svg
        png: output/in70s/noncoviddeath/pfizer/all/forest_plot.png
        tables: output/in70s/noncoviddeath/pfizer/all/*.csv

  report_incidence_in70s_noncoviddeath_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s noncoviddeath pfizer
      all
    needs:
    - design
    - model_in70s_noncoviddeath_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/pfizer/all/*/*.svg
        png: output/in70s/noncoviddeath/pfizer/all/*/*.png

  model_in70s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s noncoviddeath az all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/noncoviddeath/az/all/*/model*.rds
        data: output/in70s/noncoviddeath/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/noncoviddeath/az/all/*/weights*

  report_ipw_in70s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s noncoviddeath az all
    needs:
    - design
    - model_in70s_noncoviddeath_az_all
    outputs:
      highly_sensitive:
        broom: output/in70s/noncoviddeath/az/all/*/broom*.rds
        gt: output/in70s/noncoviddeath/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/noncoviddeath/az/all/*/plot*.svg
        tables: output/in70s/noncoviddeath/az/all/*/tab*.html
        data: output/in70s/noncoviddeath/az/all/*/broom*.csv

  report_msm_in70s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s noncoviddeath az all
    needs:
    - design
    - model_in70s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/az/all/forest_plot.svg
        png: output/in70s/noncoviddeath/az/all/forest_plot.png
        tables: output/in70s/noncoviddeath/az/all/*.csv

  report_incidence_in70s_noncoviddeath_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s noncoviddeath az all
    needs:
    - design
    - model_in70s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/noncoviddeath/az/all/*/*.svg
        png: output/in70s/noncoviddeath/az/all/*/*.png

  model_in70s_death_any_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s death any all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/death/any/all/*/model*.rds
        data: output/in70s/death/any/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/death/any/all/*/weights*

  report_ipw_in70s_death_any_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s death any all
    needs:
    - design
    - model_in70s_death_any_all
    outputs:
      highly_sensitive:
        broom: output/in70s/death/any/all/*/broom*.rds
        gt: output/in70s/death/any/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/death/any/all/*/plot*.svg
        tables: output/in70s/death/any/all/*/tab*.html
        data: output/in70s/death/any/all/*/broom*.csv

  report_msm_in70s_death_any_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s death any all
    needs:
    - design
    - model_in70s_death_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/any/all/forest_plot.svg
        png: output/in70s/death/any/all/forest_plot.png
        tables: output/in70s/death/any/all/*.csv

  report_incidence_in70s_death_any_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s death any all
    needs:
    - design
    - model_in70s_death_any_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/any/all/*/*.svg
        png: output/in70s/death/any/all/*/*.png

  model_in70s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s death pfizer all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/death/pfizer/all/*/model*.rds
        data: output/in70s/death/pfizer/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/death/pfizer/all/*/weights*

  report_ipw_in70s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s death pfizer all
    needs:
    - design
    - model_in70s_death_pfizer_all
    outputs:
      highly_sensitive:
        broom: output/in70s/death/pfizer/all/*/broom*.rds
        gt: output/in70s/death/pfizer/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/death/pfizer/all/*/plot*.svg
        tables: output/in70s/death/pfizer/all/*/tab*.html
        data: output/in70s/death/pfizer/all/*/broom*.csv

  report_msm_in70s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s death pfizer all
    needs:
    - design
    - model_in70s_death_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/pfizer/all/forest_plot.svg
        png: output/in70s/death/pfizer/all/forest_plot.png
        tables: output/in70s/death/pfizer/all/*.csv

  report_incidence_in70s_death_pfizer_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s death pfizer all
    needs:
    - design
    - model_in70s_death_pfizer_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/pfizer/all/*/*.svg
        png: output/in70s/death/pfizer/all/*/*.png

  model_in70s_death_az_all:
    run: r:latest analysis/R/dose_1/model_msm.R in70s death az all
    needs:
    - design
    - data_stset_in70s
    - data_samples_in70s
    outputs:
      highly_sensitive:
        models: output/in70s/death/az/all/*/model*.rds
        data: output/in70s/death/az/all/*/data*.rds
      moderately_sensitive:
        weights: output/in70s/death/az/all/*/weights*

  report_ipw_in70s_death_az_all:
    run: r:latest analysis/R/dose_1/report_ipw.R in70s death az all
    needs:
    - design
    - model_in70s_death_az_all
    outputs:
      highly_sensitive:
        broom: output/in70s/death/az/all/*/broom*.rds
        gt: output/in70s/death/az/all/*/gt*.rds
      moderately_sensitive:
        plots: output/in70s/death/az/all/*/plot*.svg
        tables: output/in70s/death/az/all/*/tab*.html
        data: output/in70s/death/az/all/*/broom*.csv

  report_msm_in70s_death_az_all:
    run: r:latest analysis/R/dose_1/report_msm.R in70s death az all
    needs:
    - design
    - model_in70s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/az/all/forest_plot.svg
        png: output/in70s/death/az/all/forest_plot.png
        tables: output/in70s/death/az/all/*.csv

  report_incidence_in70s_death_az_all:
    run: r:latest analysis/R/dose_1/report_incidence.R in70s death az all
    needs:
    - design
    - model_in70s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/death/az/all/*/*.svg
        png: output/in70s/death/az/all/*/*.png

  report_ipw_in70s_all:
    run: r:latest analysis/R/dose_1/report_vaxmodel.R in70s death all
    needs:
    - design
    - report_ipw_in70s_death_any_all
    - report_ipw_in70s_death_pfizer_all
    - report_ipw_in70s_death_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/plot_vax1.svg
        csv: output/in70s/tab_vax1.csv
        csv_wide: output/in70s/tab_vax1_wide.csv

  report_in70s_all:
    run: r:latest analysis/R/dose_1/report_msm_combined.R in70s all
    needs:
    - design
    - report_msm_in70s_postest_any_all
    - report_msm_in70s_postest_pfizer_all
    - report_msm_in70s_postest_az_all
    - report_msm_in70s_covidadmitted_any_all
    - report_msm_in70s_covidadmitted_pfizer_all
    - report_msm_in70s_covidadmitted_az_all
    - report_msm_in70s_coviddeath_any_all
    - report_msm_in70s_coviddeath_pfizer_all
    - report_msm_in70s_coviddeath_az_all
    - report_msm_in70s_noncoviddeath_any_all
    - report_msm_in70s_noncoviddeath_pfizer_all
    - report_msm_in70s_noncoviddeath_az_all
    outputs:
      moderately_sensitive:
        svg: output/in70s/combined/all/*.svg
        png: output/in70s/combined/all/*.png
        csv: output/in70s/combined/all/*.csv

